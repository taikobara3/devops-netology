# Домашнее задание к занятию "13.Введение в мониторинг"

## Обязательные задания

1. _Вас пригласили настроить мониторинг на проект. На онбординге вам рассказали, что проект представляет из себя 
платформу для вычислений с выдачей текстовых отчетов, которые сохраняются на диск. Взаимодействие с платформой 
осуществляется по протоколу http. Также вам отметили, что вычисления загружают ЦПУ. Какой минимальный набор метрик вы
выведите в мониторинг и почему?_

I - Мониторинг дисковой подсистемы - для предотвращения переполнения дисковой подсистемы, исключения снижения эффективности работы ПО из-за недостатка или деградации производительности дисковой подсистемы, потери данных из-за сбоев дисков)
   а) наличие свободного пространства и динамика прироста 
   б) свободные inod
   в) длина очереди дисковых операций, латентность, IOpS
   г) по возможности - состояние smart дисков и/или информацию по RAID массиву

II - Общая производительность сервера - для оценки производительности, выявления узких мест, для оценки необходимости перерапределения ресурсов
   а) загрузка CPU (текущая, и в динамике)
   б) интегральная загруженность системы (load averages в top)
   в) утилизация оперативной памяти (свободная память, динамика утилизация - для диагностики возможных утечек)
   г) процент нагрузки на систему, создаваемой отдельными группами процессов (системное ПО, вычисление, генерация отчетов)

III - Оценка работы ПО - для оценки производительности, нагрузки, SLI
   а) количество запросов
   б) соотношение корректных и некорректных ответов сервера  
   в) доступность серверного ПО (по тесту API, или тестовым запросам)
   г) количество выполненных вычислений и отчетов за интервалы времени

IV - Мониторинг безопасности
   а) валидность SSL сертификатов
   б) неудачные авторизации в ПО и на сервере
   в) география запросов по GeoIP - для оптимизации производительности, разбора инцидентов, предотвращения ddos атак

2. _Менеджер продукта посмотрев на ваши метрики сказал, что ему непонятно что такое RAM/inodes/CPUla. Также он сказал, 
что хочет понимать, насколько мы выполняем свои обязанности перед клиентами и какое качество обслуживания. Что вы 
можете ему предложить?_

Можно предложить графическое представление (в Grafana или Zabbix) получаемых метрик соответствия SLI согласованным целям SLO за фиксированные промежутки времени (например, по соотношению корректных и некорректных ответов сервера).

3. _Вашей DevOps команде в этом году не выделили финансирование на построение системы сбора логов. Разработчики в свою 
очередь хотят видеть все ошибки, которые выдают их приложения. Какое решение вы можете предпринять в этой ситуации, 
чтобы разработчики получали ошибки приложения?_

Для решения подобной задачи, наверное, не обязательно наличие какой-то системы сбора логов, требующей финансирования. 
Задачу можно реализовать:
   а) самописным скриптом, анализирующим логи приложений, и высылающим найденные ошибки по почте
   б) использованием приложения Logsentry, которое по сути делает именно это же
   в) логи, особенно если они выводятся в syslog - можно выводить на один сервер, это штатная функция syslog - там ошибки можно смотреть теми же способами, или просто grep

4. _Вы, как опытный SRE, сделали мониторинг, куда вывели отображения выполнения SLA=99% по http кодам ответов. 
Вычисляете этот параметр по следующей формуле: summ_2xx_requests/summ_all_requests. Данный параметр не поднимается выше 
70%, но при этом в вашей системе нет кодов ответа 5xx и 4xx. Где у вас ошибка?_

Вероятно, ошибка в том, что как корректные ответы не учитываются коды ответов 1xx и 2xx

## Дополнительное задание (со звездочкой*) - необязательно к выполнению

Вы устроились на работу в стартап. На данный момент у вас нет возможности развернуть полноценную систему 
мониторинга, и вы решили самостоятельно написать простой python3-скрипт для сбора основных метрик сервера. Вы, как 
опытный системный-администратор, знаете, что системная информация сервера лежит в директории `/proc`. 
Также, вы знаете, что в системе Linux есть  планировщик задач cron, который может запускать задачи по расписанию.

Суммировав все, вы спроектировали приложение, которое:
- является python3 скриптом
- собирает метрики из папки `/proc`
- складывает метрики в файл 'YY-MM-DD-awesome-monitoring.log' в директорию /var/log 
(YY - год, MM - месяц, DD - день)
- каждый сбор метрик складывается в виде json-строки, в виде:
  + timestamp (временная метка, int, unixtimestamp)
  + metric_1 (метрика 1)
  + metric_2 (метрика 2)
  
     ...
     
  + metric_N (метрика N)
  
- сбор метрик происходит каждую 1 минуту по cron-расписанию

Для успешного выполнения задания нужно привести:

а) работающий код python3-скрипта,

б) конфигурацию cron-расписания,

в) пример верно сформированного 'YY-MM-DD-awesome-monitoring.log', имеющий не менее 5 записей,

P.S.: количество собираемых метрик должно быть не менее 4-х.
P.P.S.: по желанию можно себя не ограничивать только сбором метрик из `/proc`.

---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
