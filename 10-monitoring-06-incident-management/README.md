# Домашнее задание к занятию 17 «Инцидент-менеджмент»

## Основная часть

Составьте постмортем на основе реального сбоя системы GitHub в 2018 году.

Информация о сбое: 

* [в виде краткой выжимки на русском языке](https://habr.com/ru/post/427301/);
* [развёрнуто на английском языке](https://github.blog/2018-10-30-oct21-post-incident-analysis/).


**Краткое описание инцидента:**

Нарушение сетевой связанности между сетевым концентратором и центром обработки данных привело к ухудшению качества обслуживания на 24 часа 11 минут (на время инцидента метаданные вебсайта, касающиеся Issue и PR могли быть не актуальными, созданные изменения не сохранялись, была нарушена авторизация. Данные, хранящиеся в репозиториях затронуты не были)
Также, на время восстановительных работ была приостановлена работа веб-хуков

**События, предшествовавшие инциденту**

Аварийные работы по замене вышедшего из строя сетевого 100-гигабитного оптического оборудования на восточном побережье США 21 октября  в 22:52 (здесь и далее - UTC)

**Причина инцидента**

Неверная в рамках инфраструктуры настройка репликатора MySQL orchestrator. Краткосрочное нарушение сетевой связанности послужило триггером к цепочке событий, приведших к рассогласованию кластера MeSQL

**Воздействие**

В течении 24 часов и 11 минут все пользователи испытывали проблемы при работе с сайтом: не работали Issues, Webhooks, невозможно было создать и разместить странички на GitHub Pages, на сайте отображалась устаревшая или неполная информация.

**Обнаружение**

В 22:54 - сообщения системы мониторинга о многочисленных ошибках
В 23:02 - дежурные инженеры обнаружили, что кластеры БД находятся в состоянии unexpected

**Реакция**

Дежурные инженеры перевели систему в статус "желтый", и подключили менеджера по инцидентам, который перевел систему в статус "красный"
Инженеры из команды администрирования отключили часть сервисов для снижения нагрузки на систему, и предотвращения дальнейшей потери данных

**Восстановление**

Восстановление основного кластера на восточном побережье, дальнейшая репликация актуальных ранных из кластера на западном побережье, развертывание дополнительных кластеров, постепенное возвращение отключенных сервисов

**Таймлайн**

21 октября 22:52: Развал кластера БД

22:54: Оповещения систем мониторинга

23:02: Обнаружение дежурными инженерами кластеров БД в состоянии unexpected 

23:07: Блокировка утилит деплоя для предотвращения дальнейшего повреждения метаданных

23:19: Желтый статус, координатору по инцидентам отправлено оповещение

23:11: Подключение координатора, изменение статуса на "красный"

23:13: Подключение инженеров по БД

23:19: Остановка работы веб-хуков и сборки страниц

21 октября 00:05: Начало работ по восстановлению консистентности кластера

00:41: Начало восстановления кластера на восточном побережье из бекапа

06:51: Начало репликации данных на восстановленные кластеры с западного побережья

07:46: Публикация информации для пользователей

11:12: Восстановление основного кластера, однако некоторые read-only БД запаздывали с репликацией, в понедельник началась активная работа пользователей

13:15: Пик нагрузки на сервера, разрыв запаздывания репликации начал увеличиваться. Были подключены дополнительные кластеры MySQL на чтение

16:24: Завершение синхронизации кластера

16:45: Начало обработки накопившихся событий, в беклоге были отложены миллион событий в хуках и 80 тысяч запросов на создание GitHub Pages

23:03: Работа веб-хуков и GutHub Pages восстановлена, нормализация работ всех систем подтверждена

**Последующие действия**

Анализ возможностей по восстановлению нескольких журналов СУБД, с данными не реплицированными на западное побережье.

Исправление конфигурации Orchestrator, чтобы предотвратить передачу primary роли между регионами

Переработка систем оповещения о статусе системы, с целью повышения ее информативности

Предварительно начатые работы по повышению безотказности системы (в т.ч. при отказе целого датацентра)

Планы по повышению проактивности в достижении большей отказоустойчивости

Большие инвестиции в chaos engineering, тестирование различных сценариев отказа.


---

### Как оформить решение задания

Выполненное домашнее задание пришлите в виде ссылки на .md-файл в вашем репозитории.

---
