# Clickhouse

## Что делает playbook:

Playbook разворачивает на заданных хостах приложения:
- сlickhouse-client
- clickhouse-server
- clickhouse-common
- vector
- lighthouse
Запускает clickhouse-server, создает базу данных
Запускает nginx (доступ к странице lighthouse по адресу http://[адрес_хоста_lighthouse]/lighthouse-master)
Плейбук рассчитан на использование только на машинах, управляемых ОС с пакетным менеджером yum, и тестировался только на Centos 7

## Параметры
- IP целевых хостов надо задать в параметре ansible_host файла inventory/prod.yml (хост для развертывания трех приложений clickhouse - в секции clickhouse-01, хост для развертывания vector -  секции vector, для развертывания lighthouse и вспомогательного веб-сервера - в секции lighthouse ), там же указать пользователя ssh для которого настроен вход по сертификату, приватный ключ которого указывается здесь же
- пользователь, под именем которого ansible будет осуществлять вход на удаленный хост, указывается в этом же файле, в параметре ansible_ssh_user. В домашней директории этого пользователя, в директории ~/.ssh должен располагаться публичный ключ, приватная часть которого указана в переменной ansible_ssh_private_key_file каждой хостовой секции этого файла. Внимание! Пееред использование плейбука,надо либо осуществить вход по ssh интерактивно, либо запустить плейбук в интерактивном режиме, для принятия отпечатка публичного ключа на удаленных управляемых хостах. 
- этот пользователь должен быть в группе sudo с правами root для запуска менеджера приложений, изменений прав на файлах и директориях, запуска и остановки демонов. 
- версии и архитектура пакетов указываются в файле group_vars/clickhouse/vars.yml  в переменных clickhouse_version (версия clickhouse), vector_major(minor)_version (минорная и мажорные версии vector) и vector_arch (архитектура хоста - только для vector)

## Теги
- clickhouse
- vector
- lighthouse
